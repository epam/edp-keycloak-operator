apiVersion: v1
kind: Secret
metadata:
  name: secret-name
type: Opaque
data:
  secretKey: dGVzdAo=

# we use secretKey from secret-name secret for clientSecret field
---
apiVersion: v1.edp.epam.com/v1
kind: KeycloakRealmIdentityProvider
metadata:
  name: keycloakrealmidentityprovider-sample
spec:
  realmRef:
    kind: KeycloakRealm
    name: keycloakrealm-sample
  alias: github
  authenticateByDefault: false
  enabled: true
  firstBrokerLoginFlowAlias: "first broker login"
  postBrokerLoginFlowAlias: "browser"
  providerId: "github"
  config:
    clientId: "foo"
    clientSecret: "$secret-name:secretKey"
    syncMode: "IMPORT"
    useJwksUrl: "true"
  mappers:
    - name: "test-33221"
      identityProviderMapper: "hardcoded-attribute-idp-mapper"
      identityProviderAlias: "github"
      config:
        attribute: "foo"
        "attribute.value": "bar"
        syncMode: "IMPORT"

# We define clientSecret in clear form in CR
---
apiVersion: v1.edp.epam.com/v1
kind: KeycloakRealmIdentityProvider
metadata:
  name: keycloakrealmidentityprovider-sample-with-pass
spec:
  realmRef:
    kind: KeycloakRealm
    name: keycloakrealm-sample
  alias: facebook
  authenticateByDefault: false
  enabled: true
  firstBrokerLoginFlowAlias: "first broker login"
  providerId: "facebook"
  config:
    clientId: "bar"
    clientSecret: "password-in-clear-form"
    syncMode: "IMPORT"
    useJwksUrl: "true"
  mappers:
    - name: "mymapper"
      identityProviderMapper: "hardcoded-attribute-idp-mapper"
      identityProviderAlias: "github"
      config:
        attribute: "foo"
        "attribute.value": "bar"
        syncMode: "IMPORT"
